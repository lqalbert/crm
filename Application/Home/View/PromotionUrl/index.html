<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>推广页面Url</title>
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/Jcrop/jquery.Jcrop.min.css"/>
	<!-- 不支持IE9 及以下的浏览器 -->
	<!--[if lte IE 9]> 
	<script>
		window.location.href="{:U('login/notsupport')}";
	</script>
	<![endif]-->
  <style>
	  *{font-family: microsoft YaHei;}
		.layui-form-item {
			width: 33.33333333%;
			float: left;
			margin-bottom: 15px;
			clear: both;
		/*    line-height: 40px;*/
		}
		.layui-form .layui-form-item label.layui-form-label {
	    width: 120px;
	    font-family: "Microsoft YaHei";
		}

		.layui-form-label {
	    float: left;
	    display: block;
	    padding: 9px 15px;
	    width: 80px;
	    font-weight: 400;
	    text-align: right;
		}

		.layui-form-label, .layui-form-mid, .layui-textarea {
	    line-height: 20px;
	    position: relative;
		}
		.layui-input-block {
	    margin-left: 160px;
		}
		.layui-input-block {
	    margin-left: 110px;
	    min-height: 36px;
		}
		.layui-input-block, .layui-input-inline {
	    position: relative;
		}
		.layui-upload-file {
	    position: relative;
	    display: inline-block;
	    vertical-align: middle;
	    margin-left:10px;
	    min-width: 120px;
	    height: 38px;
	    border: 1px solid #20a0ff;
	    border-radius: 4px;
	    overflow: hidden;
	    color: #fff;
	    background-color: #20a0ff;
	    cursor:pointer;
		}
		.layui-upload-file {
	    outline: 0;
	    -webkit-transition: border-color .3s cubic-bezier(.65,.05,.35,.5);
	    transition: border-color .3s cubic-bezier(.65,.05,.35,.5);
	    -webkit-box-sizing: border-box!important;
	    -moz-box-sizing: border-box!important;
	    box-sizing: border-box!important;
		}
		.el-col-16 {
	    width:800px;
	    box-sizing: border-box;
		}
		.el-alert--error {
		  background-color: #ff4949;
		}
		.el-alert {
		  width: 100%;
		  padding: 8px 0px;
		  margin: 0;
		  border-radius: 4px;
		  position: relative;
		  overflow: hidden;
		  color: #fff;
		  opacity: 1;
		  display: table;
		  transition: opacity .2s;
		}
		.el-alert__content {
		  display: table-cell;
		  padding: 0 8px;
		}
		.el-alert__title {
		  font-size: 18px;
		  line-height: 18px;
		  font-weight: 600;
		}
		.el-input {
		  position: relative;
		  font-size: 14px;
		  display: inline-block;
		  width: 100%;
		}
		.el-input.is-disabled .el-input__inner {
		  margin-top: 20px;
		  background-color: #EFF2F7;
		  border-color: #D3DCE6;
		  color: #3a3636;
		  cursor: text;
		  font-size: 18px;
		}
		.el-input__inner {
		  -moz-appearance: none;
		  appearance: none;
		  background-color: #fff;
		  border-radius: 4px;
		  border: 1px solid #c0ccda;
		  color: #1f2d3d;
		  display: block;
		  font-size: inherit;
		  height: 36px;
		  line-height: 1;
		  padding: 3px 10px;
		  width: 100%;
		}
		.el-input__inner, .el-textarea__inner {
		  background-image: none;
		  transition: border-color .2s cubic-bezier(.645,.045,.355,1);
		  box-sizing: border-box;
		}
		.el-button, .el-input__inner {
		  -webkit-appearance: none;
		  outline: 0;
		}
		#qq-fileList{margin-top:10px;margin-left:20px;font-size:16px;}
		#tips{margin-top:10px;margin-left:20px;font-size:16px;font-weight:700;color:#ff4949;}
		#wx-refresh,#qq-refresh{display:none;background-color: #ff4949;border-color: #ff4949;height: 30px;}
  </style>
</head>
<body>
  <div class="el-col-16">
  	<div class="el-alert el-alert--error">
  		<div class="el-alert__content">
  			<span class="el-alert__title">以下为您的推广链接,请全选->右击复制(或ctrl+c)->右键粘贴(或ctrl+v)！</span>
  		</div>
  	</div>
  </div>

  <div class="el-col-16">
  	<div class="el-input is-disabled">
  		<input type="text" disabled="disabled" autocomplete="off" class="el-input__inner" value="{$res.urlRes}"/>
  	</div>
  </div>
  <div id="tips">请只截取中间二维码部分！！！</div>
  <div class="layui-form-item" style="margin-top:20px;">
    <label class="layui-form-label">微信二维码</label>
    <div class="layui-input-block">
      <input id="wx-qr" type="button" class="layui-upload-file" value="选择微信二维码图"/>
    </div>
    <div id="wx-fileList" style="margin-top:10px;margin-left:20px;font-size:13px;"></div>  
    <img  id="show-wxqr" alt="" src="{$res.wxqrImg}" style="margin:10px 20px;"/> 
    <input id="wx-upload" type="button" class="layui-upload-file" value="确定截图" style="display:none;margin-left:20px;float: right;"/>
    <input id="wx-refresh" type="button" class="layui-upload-file" value="如不满意点击刷新再传"/>
  </div>

  <div class="layui-form-item">
    <label class="layui-form-label">QQ二维码</label>
    <div class="layui-input-block">
      <input id="qq-qr" type="button" class="layui-upload-file" value="选择QQ二维码图"/>
    </div>
    <div id="qq-fileList"></div>  
    <img  id="show-qqqr" alt="" src="{$res.qqqrImg}" style="margin:10px 20px;"/>
    <input id="qq-upload" type="button" class="layui-upload-file" value="确定截图" style="display:none;margin-left:20px;float: right;"/>
    <input id="qq-refresh" type="button" class="layui-upload-file" value="如不满意点击刷新再传"/>
  </div>
 
<script type="text/javascript" src="__PUBLIC__/js/jquery.1.11.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/js/Jcrop/jquery.Jcrop.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/js/Jcrop/imageCropperUpload.js"></script>
<script>
  var webRoot = "__ROOT__";
  var qqqrImg = "{$res.qqqrImg}";
  var wxqrImg = "{$res.wxqrImg}";
  var commonConfig = {
    commonFileSuffixs:["jpg", "png", "jpeg","gif"],
    commonErrorText:"{0}",
    commonCropperParam: {
      maxSize: [300, 300],//不要小于50，如maxSize:[40,24]
      minSize: [200, 200],//不要小于50，如minSize:[40,24]
      bgColor: "black",
      bgOpacity: .4,  
      allowResize: true,  
      allowSelect: false,
      animationDelay:10,
      aspectRatio:1,
    },
    commonPerviewImgStyle:{width: '700px', height: '500px',border: '1px solid #ebebeb'}
  };
  $(function () {  
    var btn = $("#wx-qr");
    btn.click(function () {  
      $("#wx-upload").show();
    }); 
    btn.cropperUpload({  
      url: "{:U('Upload/imageCropperUpload?folder=wxqr')}",
      fileSuffixs: commonConfig.commonFileSuffixs,  
      errorText: commonConfig.commonErrorText,  
      onComplete: function (msg) {  
        $("#wx-fileList").hide();
        $("#show-wxqr").attr("src", webRoot+msg);
        if(wxqrImg == ""){
        	window.location.reload();
        }else{
        	$('#wx-refresh').show();
        	btn.attr('disabled',"true");
        	btn.css({"background-color":"#c2c2c2","border-color":"#c2c2c2","color":"#ffffff","cursor":"not-allowed"});
        }
        $("#wx-upload").hide();
      },
      //Jcrop参数设置，除onChange和onSelect不要使用，其他属性都可用
      cropperParam: commonConfig.commonCropperParam,  
      perviewImageElementId: "wx-fileList", //设置预览图片的元素id    
      perviewImgStyle: commonConfig.commonPerviewImgStyle//设置预览图片的样式    
    });  

    var upload = btn.data("uploadFileData");  

    $("#wx-upload").click(function () {  
      upload.submitUpload();
    });  

    $('#wx-refresh').click(function() {
    	window.location.reload();
    });

  });  
</script>
<script>
  $(function () {  
    var btn = $("#qq-qr");
    btn.click(function () {  
      $("#qq-upload").show();
    }); 
    btn.cropperUpload({  
      url: "{:U('Upload/imageCropperUpload?folder=qqqr')}",
      fileSuffixs: commonConfig.commonFileSuffixs,  
      errorText: commonConfig.commonErrorText,    
      onComplete: function (msg) {   
        $("#qq-fileList").hide();
        $("#show-qqqr").attr("src", webRoot+msg);
        if(qqqrImg == ""){
        	window.location.reload();
        }else{
        	$('#qq-refresh').show();
        	btn.attr('disabled',"true");
        	btn.css({"background-color":"#c2c2c2","border-color":"#c2c2c2","color":"#ffffff","cursor":"not-allowed"});
        }
        $("#qq-upload").hide();
      },
      //Jcrop参数设置，除onChange和onSelect不要使用，其他属性都可用
      cropperParam: commonConfig.commonCropperParam,   
      perviewImageElementId: "qq-fileList", //设置预览图片的元素id    
      perviewImgStyle: commonConfig.commonPerviewImgStyle//设置预览图片的样式    
    });  

    var upload = btn.data("uploadFileData");  

    $("#qq-upload").click(function () {
      upload.submitUpload();  
    }); 
    $('#qq-refresh').click(function() {
    	window.location.reload();
    });
  });  
</script>
</body>
</html>