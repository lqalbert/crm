<extend name="Common:base" />
<block name="head">
	<style>
    .el-table__body tr.current-row>td{
      background: rgba(157, 195, 232, 0.7);
    }
	</style>
</block>
<block name="body">
<div id="app" class="container">
  <div class="wrapp" id="appx" v-show="show" style="display:none;">
    <el-row>
      <el-col :span="24">
        <el-form :inline="true" ref="searchForm" :model="searchForm">
	        <el-form-item prop="date">
	          <el-date-picker clearable size="small"  v-model="searchForm.dist" placeholder="请选择日期"  @change="dateChange">
	          </el-date-picker>
	        </el-form-item>

          <el-form-item prop="department_id" style="width:170px">
              <el-select v-model="searchForm.department_id" size="small" clearable @change="departmentChange" width="50" placeholder="部门">
                  <el-option v-for="item in departments" :key="item.id" :label="item.name" :value="item.id"></el-option>
              </el-select>
          </el-form-item>

            <el-form-item prop="group_id" style="width:170px">
                <el-select v-model="searchForm.group_id" size="small" clearable width="50" placeholder="团队小组">
                    <el-option v-for="item in groups" :key="item.id" :label="item.name" :value="item.id"></el-option>
                </el-select>
            </el-form-item>

	        <el-form-item prop="name" style="width:170px">
	          <el-input v-model="searchForm.realname" size="small" placeholder="员工姓名关键字"></el-input>
	        </el-form-item>

	        <el-form-item prop="field" v-show="false">
	          <input type="hidden" size="small" v-model="searchForm.field"/>
	        </el-form-item>

	        <el-form-item>
	          <el-button type="info" size="small" icon="search"  @click="loadDatalist" >查询</el-button> 
	          <el-tooltip content="清空搜索框并刷新表格数据" placement="bottom-start" style="margin-left:10px;">
	            <el-button  size="small" @click="searchReset2"  >重置</el-button>
	          </el-tooltip>
	          <el-tooltip content="点击刷新当前页面" placement="right"  style="margin-left:10px;">
	            <el-button  size="small" type="danger" @click="refresh" >刷新</el-button>
	          </el-tooltip>
	        </el-form-item>

        </el-form>
      </el-col>
    </el-row>
    <el-row>
      <el-col :span="24">
        <el-table :data="dataList" border v-loading="dataLoad"
         element-loading-text="{:L('DATA_LOGIN')}" highlight-current-row empty-text="暂无统计数据！" ref="select" >
          <el-table-column width="50" align="center" type="selection"></el-table-column>

          <el-table-column  label="序号"  align="center" width="65" :formatter="handleIndex"></el-table-column>

            <el-table-column prop="department_name" label="部门" align="center" header-align="center"></el-table-column>

            <el-table-column prop="group_name" label="团队" align="center" header-align="center"></el-table-column>
          
          <el-table-column prop="realname" label="员工" header-align="center"></el-table-column>

          <el-table-column prop="date" width="120" label="日期" align="center"></el-table-column>

          <el-table-column prop="phone_track" width="100" label="电话跟踪" align="center"></el-table-column>

            <el-table-column prop="door_track" width="100" label="上门服务" align="center"></el-table-column>

          <el-table-column prop="qq_track" width="100" label="QQ跟踪" align="center"></el-table-column>

            <el-table-column prop="email_track" width="120" label="email跟踪" align="center"></el-table-column>

          <el-table-column prop="weixin_track" width="100" label="微信跟踪" align="center"></el-table-column>

            <el-table-column prop="v_summary" width="100" label="成交总结" align="center"></el-table-column>

            <el-table-column prop="teach_track" width="100" label="讲师指导" align="center"></el-table-column>

            <el-table-column prop="captain_track" width="100" label="主管建议" align="center"></el-table-column>

            <el-table-column prop="sell_track" width="100" label="售前回访" align="center"></el-table-column>

            <el-table-column prop="risk_track" width="100" label="风控建议" align="center"></el-table-column>

            <el-table-column prop="retroaction_track" width="100" label="反馈投诉" align="center"></el-table-column>

            <el-table-column prop="other_track" width="100" label="其他方式" align="center"></el-table-column>

          <el-table-column prop="sum_track" width="120" label="总跟踪次数" align="center"></el-table-column>

          <el-table-column prop="self_track" width="100" label="锁定自跟" align="center"></el-table-column>
        </el-table>
      </el-col>
    </el-row>
    <el-row type="flex" justify="space-between" align="middle" class="row-bg">
      <el-col :span="12" :offset="12">

	      <div class="grid-content bg-purple-light pull-right">
	        <!-- page -->
	        <include file="Common:_pagination" />
	        <!-- / page -->
	      </div>

      </el-col>
    </el-row>

  </div>
</div>
</block>
<block name="scripts">
<script>
  window.defaultOption.setDatas({
      departments:{:json_encode($departments['list'])},
  groups:{:json_encode($departments['group'])}
  }).setForm('search',{
      department_id:'',
      group_id:'',
      realname:'',
      field:'',
      dist:''
  }).setMethod('refresh',function(){
  	window.location.reload();
  }).setMethod('searchReset2',function(){
    this.searchForm = Oassign({}, this._search) ;
    this.dataLoad = true;
    this.loadDatalist();
  }).setMethod('dateChange',function(v){
    this.searchForm.dist = v;
  }).setMethod('departmentChange',function () {
      var vmThis=this
      vmThis.$http.get('{:U("getAllGroups")}',{params:{department_id:vmThis.searchForm.department_id}}).then(function (response) {
          vmThis.groups=response.body
          vmThis.searchForm.group_id=''
      })
  })
</script>
</block>
